### 트랜잭션

- 더 이상 분할할 수 없는 최소 수행 단위
- 어떤 기능 한 가지를 수행하는 SQL문 덩어리

    1. 트랜잭션의 성질

    - 원자성 (Atomicity) : 트랜잭션이 DB에 모두 반영이 되거나 전혀 반영되지 않아야 함(all or nothing)
        - 어떤 트랜잭션이 실행되다 장애에 의해 부분완료되는 상황은 원자성에 위배→ 장애 회복
    - 일관성 (Consistency) : 트랜잭션 작업 처리 결과는 항상 일관성 있어야 함
        - 파일 시스템에 동시에 접근하여 덮어씌워지는 경우 일관성에 위배 → 동시성 제어, 무결성 제약 조건
    - 독립성 (Isolation) : 각각의 트랙잭션은 독립적이어야하고 서로 영향을 주지 않아야 함
        - 파일 시스템에 동시에 접근하여 덮어씌워지는 경우 독립성 위배 → 동시성 제어
    - 지속성 (Durability) : 트랜잭션 완료시 결과는 영구적으로 반영되어야 함
        - 어떤 트랜잭션이 실행되다 장애에 의해 부분완료되는 상황은 지속성 위배→ 장애 회복
    1. 트랜잭션의 상태

    ![img_4.png](img%2Fimg_4.png)
  

### 트랜잭션 장애 시 회복

1. 트랜잭션 장애의 유형
    - 트랜잭션 장애 : 트랜잭션 실행시 논리적인 오류로 발생할 수 있는 에러 상황 (ex. 잘못된 데이터 입력, 오버플로우 등)
    - 시스템 장애 : 하드웨어 시스템 자체에서 발생할 수 있는 에러 상황
    - 미디어 장애 : 디스크 자체의 손상으로 발생할 수 있는 에러 상황
2. 회복 : 데이터 베이스를 장애가 발생했던 이전의 상태로 복구시켜 일관된 데이터 상태를 만드는 것 → 미리 복사해두고 장애 발생시 복사본을 이용하여 원래의 상태로 복원
    1. 덤프(dump) : 데이터 베이스 전체를 다른 저장 장치에 주기적으로 복사하는 방법
    2. 로그(log): 변경 이전의 데이터 베이스를 기준으로 변경 연산이 발생할 깨 마다 로그 파일을 작성하여 기록하고 회복시 로그의 내용을 사용하여 복원하는 방법
        - redo(재실행) : 로그파일에 시작이 있고 종료가 있는 경우 트랜잭션이 변경한 내용을 다시 기록
        - undo(취소) : 로그파일에 시작만 있고 종료가 없는 경우 트랜잭션이 변경한 내용을 원상복구 시키는 과정