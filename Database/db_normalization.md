# 정규화(Normalization)

## 정의

관계형 데이터베이스의 설계에서 **중복을 최소화하기 위해** 데이터를 구조화하는 프로세스<br />
중복을 최소화한다는 것은 **이상 현상을 방지**하는 목적과도 결부된다. 즉, 정규화는 이상 현상을 막기 위한 프로세스라고도 할 수 있다.

> ### 이상 현상
>- 삭제 이상: 튜플 삭제 시 같이 저장된 다른 정보까지 연쇄적으로 삭제되는 현상
>- 삽입 이상: 튜플 삽입 시 특정 속성에 해당하는 값이 없어 `NULL`을 입력해야 하는 현상
>- 수정 이상: 튜플 수정 시 중복된 데이터의 일부만 수정되어 일어나는 데이터 불일치 현상

<br />

정규화의 종류에는 **제1정규화**, **제2정규화**, **제3정규화**, **BCNF 정규화** 등이 있다.

---

## 제1정규화

데이터베이스의 각 컬럼이 **원자 값(하나의 값)만을 보유**하게 하는 과정이다.

<p align="center">
<img src="./img/스크린샷 2024-05-21 오후 5.27.10.png" alt="img1" width="300"/>
</p>

위와 같은 테이블에서 ID 2번에 해당하는 수강자 필드에 데이터가 2개 들어가있다. 즉, 원자 값이 보장되지 않는 상태에서 만약 이순신의 수강과목이 바뀌게 되면 홍길동의 수강과목도 바뀌게 되는 이상현상이 발생한다.

<p align="center">
<img src="./img/스크린샷 2024-05-21 오후 5.38.13.png" alt="img1" width="300"/>
</p>

제1정규화를 거치게 되면 데이터 무결성을 지킬 수 있으며, 데이터 구조가 단순해지면서 명확해지게 된다. 이를 통해 이상현상을 방지할 수 있다.

---

## 제2정규화

제1정규화를 완료한 테이블에서, **부분 함수 종속성을 제거**하는 과정이다.

### 함수 종속성

부분 함수 종속성을 제거하는 것은 곧 **완전 함수 종속성을 만족**하는 것과 같다. 완전 함수 종속이 되기 위해서는 기본키의 부분집합이 곧 결정자가 되어서는 안된다.

<p align="center">
<img src="./img/스크린샷 2024-05-21 오후 5.49.29.png" alt="img1" width="300"/>
</p>

만약 위처럼 기본 키(학생번호, 강좌이름)의 부분집합에 의존하는 컬럼들(강의실, 성적)이 존재하면, 해당 컬럼들을 분리해 새로운 테이블을 생성해서 주제의 일관성을 유지하는 것이 좋다.

<p align="center">
<img src="./img/스크린샷 2024-05-21 오후 5.52.52.png" alt="img1" width="300"/>
</p>

이를 통해 한 테이블에 다양한 부분집합에 의존하는 컬럼들로 인해 발생할 수 있는 데이터 중복을 없애고 무결성을 유지하면서 이상현상을 방지하게 된다.

---

## 제3정규화

제2정규화를 완료한 테이블에서, **이행적 함수 종속성을 제거**하는 과정이다.

### 이행적 함수 종속성

`A`가 `B`에 종속되고, `B`가 `C`에 종속됨으로써, `A`가 `C`에 종속되는 성질을 말한다. 이것이 데이터베이스에서 문제가 되는 이유는 특정 컬럼의 값을 추가할 때, 존재하지 않는 컬럼 역시 강제로 값을 할당해줘야 해서 `NULL`이 할당되는 이상현상이 발생할 수 있다.

<p align="center">
<img src="./img/스크린샷 2024-05-21 오후 6.01.03.png" alt="img1" width="300"/>
</p>

위의 경우는 학생번호 컬럼이 강좌이름 컬럼에 의존하고, 강좌이름 컬럼이 수강료 컬럼에 의존하고 있다. 만약 여기서 501번 학생이 스포츠경영학이라는 과목으로 바꾼다면, 단순 강좌이름만을 바꾸는 것에서 그치지 않고 수강료까지 같이 수정이 일어나게 된다.

또한, 위에서 말한 대로 새로운 강좌가 추가되고 수강료가 결정되어도 듣는 학생이 존재하지 않은 상태면 학생번호는 강제로 `NULL`이 할당된다.

<p align="center">
<img src="./img/스크린샷 2024-05-21 오후 6.08.56.png" alt="img1" width="300"/>
</p>

제3정규화를 거치게 되면 컬럼의 불가결적 `NULL` 할당을 막고 특정 컬럼만을 삭제하면 종속된 다른 컬럼들도 삭제되는 이상현상을 방지할 수 있게 된다. 

---

## BCNF 정규화

제3정규화를 완료한 테이블에서, **모든 결정자가 후보키가 되도록** 하는 과정이다. 즉, 결정자이지만 후보키가 아니면 안 된다는 의미다.

<p align="center">
<img src="./img/스크린샷 2024-05-21 오후 6.17.52.png" alt="img1" width="300"/>
</p>

위에서 학생번호와 특강이름이 복합키로써 작동하고 교수 컬럼을 정하고 있는데, 교수 역시 특강이름 컬럼을 정하고 있다. 즉, 교수는 특강이름의 결정자로 존재하지만 후보키가 아니다. 그래서 아래와 같이 테이블 분리가 필요하다.

<p align="center">
<img src="./img/스크린샷 2024-05-21 오후 6.22.50.png" alt="img1" width="300"/>
</p>

---

## 제4정규화

BCNF 정규화를 완료한 테이블에서, **다치 종속(Multi-valued Dependeny)을 제거**하는 과정이다.

---

## 제5정규화

제4정규화를 완료한 테이블에서, **조인 종속(Joint Dependency)을 제거**하는 과정이다.